{"ts":1366447611437,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1366447629416,"patch":[[{"diffs":[[1,"var langs =\r\n[['Afrikaans',       ['af-ZA']],\r\n ['Bahasa Indonesia',['id-ID']],\r\n ['Bahasa Melayu',   ['ms-MY']],\r\n ['Català',          ['ca-ES']],\r\n ['Čeština',         ['cs-CZ']],\r\n ['Deutsch',         ['de-DE']],\r\n ['English',         ['en-AU', 'Australia'],\r\n                     ['en-CA', 'Canada'],\r\n                     ['en-IN', 'India'],\r\n                     ['en-NZ', 'New Zealand'],\r\n                     ['en-ZA', 'South Africa'],\r\n                     ['en-GB', 'United Kingdom'],\r\n                     ['en-US', 'United States']],\r\n ['Español',         ['es-AR', 'Argentina'],\r\n                     ['es-BO', 'Bolivia'],\r\n                     ['es-CL', 'Chile'],\r\n                     ['es-CO', 'Colombia'],\r\n                     ['es-CR', 'Costa Rica'],\r\n                     ['es-EC', 'Ecuador'],\r\n                     ['es-SV', 'El Salvador'],\r\n                     ['es-ES', 'España'],\r\n                     ['es-US', 'Estados Unidos'],\r\n                     ['es-GT', 'Guatemala'],\r\n                     ['es-HN', 'Honduras'],\r\n                     ['es-MX', 'México'],\r\n                     ['es-NI', 'Nicaragua'],\r\n                     ['es-PA', 'Panamá'],\r\n                     ['es-PY', 'Paraguay'],\r\n                     ['es-PE', 'Perú'],\r\n                     ['es-PR', 'Puerto Rico'],\r\n                     ['es-DO', 'República Dominicana'],\r\n                     ['es-UY', 'Uruguay'],\r\n                     ['es-VE', 'Venezuela']],\r\n ['Euskara',         ['eu-ES']],\r\n ['Français',        ['fr-FR']],\r\n ['Galego',          ['gl-ES']],\r\n ['Hrvatski',        ['hr_HR']],\r\n ['IsiZulu',         ['zu-ZA']],\r\n ['Íslenska',        ['is-IS']],\r\n ['Italiano',        ['it-IT', 'Italia'],\r\n                     ['it-CH', 'Svizzera']],\r\n ['Magyar',          ['hu-HU']],\r\n ['Nederlands',      ['nl-NL']],\r\n ['Norsk bokmål',    ['nb-NO']],\r\n ['Polski',          ['pl-PL']],\r\n ['Português',       ['pt-BR', 'Brasil'],\r\n                     ['pt-PT', 'Portugal']],\r\n ['Română',          ['ro-RO']],\r\n ['Slovenčina',      ['sk-SK']],\r\n ['Suomi',           ['fi-FI']],\r\n ['Svenska',         ['sv-SE']],\r\n ['Türkçe',          ['tr-TR']],\r\n ['български',       ['bg-BG']],\r\n ['Pусский',         ['ru-RU']],\r\n ['Српски',          ['sr-RS']],\r\n ['한국어',            ['ko-KR']],\r\n ['中文',             ['cmn-Hans-CN', '普通话 (中国大陆)'],\r\n                     ['cmn-Hans-HK', '普通话 (香港)'],\r\n                     ['cmn-Hant-TW', '中文 (台灣)'],\r\n                     ['yue-Hant-HK', '粵語 (香港)']],\r\n ['日本語',           ['ja-JP']],\r\n ['Lingua latīna',   ['la']]];\r\n\r\nfor (var i = 0; i < langs.length; i++) {\r\n  select_language.options[i] = new Option(langs[i][0], i);\r\n}\r\nselect_language.selectedIndex = 6;\r\nupdateCountry();\r\nselect_dialect.selectedIndex = 6;\r\nshowInfo('info_start');\r\n\r\nfunction updateCountry() {\r\n  for (var i = select_dialect.options.length - 1; i >= 0; i--) {\r\n    select_dialect.remove(i);\r\n  }\r\n  var list = langs[select_language.selectedIndex];\r\n  for (var i = 1; i < list.length; i++) {\r\n    select_dialect.options.add(new Option(list[i][1], list[i][0]));\r\n  }\r\n  select_dialect.style.visibility = list[1].length == 1 ? 'hidden' : 'visible';\r\n}\r\n\r\nvar create_email = false;\r\nvar final_transcript = '';\r\nvar recognizing = false;\r\nvar ignore_onend;\r\nvar start_timestamp;\r\nif (!('webkitSpeechRecognition' in window)) {\r\n  upgrade();\r\n} else {\r\n  start_button.style.display = 'inline-block';\r\n  var recognition = new webkitSpeechRecognition();\r\n  recognition.continuous = true;\r\n  recognition.interimResults = true;\r\n\r\n  recognition.onstart = function() {\r\n    recognizing = true;\r\n    showInfo('info_speak_now');\r\n    start_img.src = '/intl/en/chrome/assets/common/images/content/mic-animate.gif';\r\n  };\r\n\r\n  recognition.onerror = function(event) {\r\n    if (event.error == 'no-speech') {\r\n      start_img.src = '/intl/en/chrome/assets/common/images/content/mic.gif';\r\n      showInfo('info_no_speech');\r\n      ignore_onend = true;\r\n    }\r\n    if (event.error == 'audio-capture') {\r\n      start_img.src = '/intl/en/chrome/assets/common/images/content/mic.gif';\r\n      showInfo('info_no_microphone');\r\n      ignore_onend = true;\r\n    }\r\n    if (event.error == 'not-allowed') {\r\n      if (event.timeStamp - start_timestamp < 100) {\r\n        showInfo('info_blocked');\r\n      } else {\r\n        showInfo('info_denied');\r\n      }\r\n      ignore_onend = true;\r\n    }\r\n  };\r\n\r\n  recognition.onend = function() {\r\n    recognizing = false;\r\n    if (ignore_onend) {\r\n      return;\r\n    }\r\n    start_img.src = '/intl/en/chrome/assets/common/images/content/mic.gif';\r\n    if (!final_transcript) {\r\n      showInfo('info_start');\r\n      return;\r\n    }\r\n    showInfo('');\r\n    if (window.getSelection) {\r\n      window.getSelection().removeAllRanges();\r\n      var range = document.createRange();\r\n      range.selectNode(document.getElementById('final_span'));\r\n      window.getSelection().addRange(range);\r\n    }\r\n    if (create_email) {\r\n      create_email = false;\r\n      createEmail();\r\n    }\r\n  };\r\n\r\n  recognition.onresult = function(event) {\r\n    var interim_transcript = '';\r\n    if (typeof(event.results) == 'undefined') {\r\n      recognition.onend = null;\r\n      recognition.stop();\r\n      upgrade();\r\n      return;\r\n    }\r\n    for (var i = event.resultIndex; i < event.results.length; ++i) {\r\n      if (event.results[i].isFinal) {\r\n        final_transcript += event.results[i][0].transcript;\r\n      } else {\r\n        interim_transcript += event.results[i][0].transcript;\r\n      }\r\n    }\r\n    final_transcript = capitalize(final_transcript);\r\n    final_span.innerHTML = linebreak(final_transcript);\r\n    interim_span.innerHTML = linebreak(interim_transcript);\r\n    if (final_transcript || interim_transcript) {\r\n      showButtons('inline-block');\r\n    }\r\n  };\r\n}\r\n\r\nfunction upgrade() {\r\n  start_button.style.visibility = 'hidden';\r\n  showInfo('info_upgrade');\r\n}\r\n\r\nvar two_line = /\\n\\n/g;\r\nvar one_line = /\\n/g;\r\nfunction linebreak(s) {\r\n  return s.replace(two_line, '<p></p>').replace(one_line, '<br>');\r\n}\r\n\r\nvar first_char = /\\S/;\r\nfunction capitalize(s) {\r\n  return s.replace(first_char, function(m) { return m.toUpperCase(); });\r\n}\r\n\r\nfunction createEmail() {\r\n  var n = final_transcript.indexOf('\\n');\r\n  if (n < 0 || n >= 80) {\r\n    n = 40 + final_transcript.substring(40).indexOf(' ');\r\n  }\r\n  var subject = encodeURI(final_transcript.substring(0, n));\r\n  var body = encodeURI(final_transcript.substring(n + 1));\r\n  window.location.href = 'mailto:?subject=' + subject + '&body=' + body;\r\n}\r\n\r\nfunction copyButton() {\r\n  if (recognizing) {\r\n    recognizing = false;\r\n    recognition.stop();\r\n  }\r\n  copy_button.style.display = 'none';\r\n  copy_info.style.display = 'inline-block';\r\n  showInfo('');\r\n}\r\n\r\nfunction emailButton() {\r\n  if (recognizing) {\r\n    create_email = true;\r\n    recognizing = false;\r\n    recognition.stop();\r\n  } else {\r\n    createEmail();\r\n  }\r\n  email_button.style.display = 'none';\r\n  email_info.style.display = 'inline-block';\r\n  showInfo('');\r\n}\r\n\r\nfunction startButton(event) {\r\n  if (recognizing) {\r\n    recognition.stop();\r\n    return;\r\n  }\r\n  final_transcript = '';\r\n  recognition.lang = select_dialect.value;\r\n  recognition.start();\r\n  ignore_onend = false;\r\n  final_span.innerHTML = '';\r\n  interim_span.innerHTML = '';\r\n  start_img.src = '/intl/en/chrome/assets/common/images/content/mic-slash.gif';\r\n  showInfo('info_allow');\r\n  showButtons('none');\r\n  start_timestamp = event.timeStamp;\r\n}\r\n\r\nfunction showInfo(s) {\r\n  if (s) {\r\n    for (var child = info.firstChild; child; child = child.nextSibling) {\r\n      if (child.style) {\r\n        child.style.display = child.id == s ? 'inline' : 'none';\r\n      }\r\n    }\r\n    info.style.visibility = 'visible';\r\n  } else {\r\n    info.style.visibility = 'hidden';\r\n  }\r\n}\r\n\r\nvar current_style;\r\nfunction showButtons(style) {\r\n  if (style == current_style) {\r\n    return;\r\n  }\r\n  current_style = style;\r\n  copy_button.style.display = style;\r\n  email_button.style.display = style;\r\n  copy_info.style.display = 'none';\r\n  email_info.style.display = 'none';\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":8033}]],"length":8033,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366468756280,"patch":[[{"diffs":[[0,"ranscript;\r\n"],[1,"        console.log('final_transcript: ' + final_transcript);\r\n"],[0,"      } else"]],"start1":5380,"start2":5380,"length1":24,"length2":87},{"diffs":[[0,"ranscript;\r\n"],[1,"        console.log('interim_transcript' + interim_transcript);\r\n"],[0,"      }\r\n   "]],"start1":5522,"start2":5522,"length1":24,"length2":89}]],"length":8161,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366559184774,"patch":[[{"diffs":[[0,"0].transcript;\r\n"],[1,"        //create a temporary context for the interim word\r\n"],[0,"        console."]],"start1":5518,"start2":5518,"length1":32,"length2":91}]],"length":8220,"saved":false}
{"ts":1366560079041,"patch":[[{"diffs":[[0," = '"],[-1,"/intl/en/chrome/assets/common/"],[0,"imag"]],"start1":4502,"start2":4502,"length1":38,"length2":8}]],"length":8190,"saved":false}
{"ts":1366560094403,"patch":[[{"diffs":[[0," = '"],[-1,"/intl/en/chrome/assets/common/"],[0,"imag"]],"start1":3818,"start2":3818,"length1":38,"length2":8},{"diffs":[[0," = '"],[-1,"/intl/en/chrome/assets/common/"],[0,"imag"]],"start1":3980,"start2":3980,"length1":38,"length2":8}]],"length":8130,"saved":false}
{"ts":1366560174126,"patch":[[{"diffs":[[0," = '"],[-1,"/intl/en/chrome/assets/common/images/content"],[1,"images"],[0,"/mic"]],"start1":3641,"start2":3641,"length1":52,"length2":14},{"diffs":[[0,"c = 'images/"],[-1,"content/"],[0,"mic.gif';\r\n "]],"start1":3779,"start2":3779,"length1":32,"length2":24},{"diffs":[[0,"apture') {\r\n"],[1,""],[0,"      start_"]],"start1":3903,"start2":3903,"length1":24,"length2":24},{"diffs":[[0,"c = 'images/"],[-1,"content/"],[0,"mic.gif';\r\n "]],"start1":3933,"start2":3933,"length1":32,"length2":24},{"diffs":[[0,"'images/"],[-1,"content/"],[0,"mic.gif'"]],"start1":4391,"start2":4391,"length1":24,"length2":16},{"diffs":[[0," = '"],[-1,"/intl/en/chrome/assets/common/images/content"],[1,"images"],[0,"/mic"]],"start1":7307,"start2":7307,"length1":52,"length2":14}]],"length":8030,"saved":false}
{"ts":1366560430420,"patch":[[{"diffs":[[0,"Stamp;\r\n"],[1,"  \r\n  var card = deck.getFaceUpCard();\r\n  text = card.cardName; \r\n  console.log('starting game');\r\n  \r\n  context = document.getElementById(\"cvs\").getContext(\"2d\");            \r\n  textDirection =\"right\";\r\n  textXpos = 5;\r\n  setInterval(\"animate()\", 30);\r\n"],[0,"}\r\n\r\nfun"]],"start1":7416,"start2":7416,"length1":16,"length2":270}]],"length":8284,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366828539157,"patch":[[{"diffs":[[0,");\r\n    }\r\n  };\r"],[1,"\n  \r\n  var showWord = function(text){\r\n    var controller = new CanvasController();\r\n    controller.createText(text);\r\n  }\r"],[0,"\n\r\n  recognition"]],"start1":4824,"start2":4824,"length1":32,"length2":155},{"diffs":[[0,"inal_transcript "],[-1,"+"],[0,"= event.results["]],"start1":5311,"start2":5311,"length1":33,"length2":32},{"diffs":[[0,"anscript);\r\n"],[1,"        \r\n        \r\n        \r\n"],[0,"      } else"]],"start1":5413,"start2":5413,"length1":24,"length2":54},{"diffs":[[0,"anscript"],[1,": "],[0,"' + inte"]],"start1":5624,"start2":5624,"length1":16,"length2":18},{"diffs":[[0,"anscript);\r\n"],[1,"        //placeTextAtRandom(interim_transcript);\r\n"],[0,"      }\r\n   "]],"start1":5648,"start2":5648,"length1":24,"length2":74},{"diffs":[[0,"amp;\r\n  \r\n  "],[1,"//"],[0,"var card = d"]],"start1":7622,"start2":7622,"length1":24,"length2":26},{"diffs":[[0,"pCard();\r\n  "],[1,"//"],[0,"text = card."]],"start1":7660,"start2":7660,"length1":24,"length2":26},{"diffs":[[0,"Name; \r\n"],[1,"  \r\n"],[0,"  consol"]],"start1":7690,"start2":7690,"length1":16,"length2":20},{"diffs":[[0,");\r\n"],[-1,"  \r\n  context = document.getElementById(\"cvs\").getContext(\"2d\");            \r\n  textDirection =\"right\";\r\n  textXpos = 5;\r\n  setInterval(\"animate()\", 30);\r\n"],[0,"}\r\n\r"]],"start1":7731,"start2":7731,"length1":163,"length2":8}]],"length":8341,"saved":false}
{"ts":1366828625578,"patch":[[{"diffs":[[0,"      \r\n"],[-1,"        \r\n        \r\n"],[0,"      } "]],"start1":5427,"start2":5427,"length1":36,"length2":16},{"diffs":[[0,"anscript);\r\n"],[1,"        showWord(interim_transcript);\r\n"],[0,"      }\r\n   "]],"start1":5678,"start2":5678,"length1":24,"length2":63}]],"length":8360,"saved":false}
{"ts":1366829528574,"patch":[[{"diffs":[[1,"var controller = new CanvasController();\r\n\r\n"],[0,"var langs =\r"]],"start1":0,"start2":0,"length1":12,"length2":56},{"diffs":[[0,"){\r\n"],[-1,"    var controller = new CanvasController();\r\n"],[0,"    "]],"start1":4919,"start2":4919,"length1":54,"length2":8}]],"length":8358,"saved":false}
{"ts":1366831541329,"patch":[[{"diffs":[[0,"nscript "],[1,"+"],[0,"= event."]],"start1":5317,"start2":5317,"length1":16,"length2":17},{"diffs":[[0,");\r\n"],[-1,"        showWord(interim_transcript);\r\n"],[0,"    "]],"start1":5685,"start2":5685,"length1":47,"length2":8},{"diffs":[[0,"anscript);\r\n"],[1,"    showWord(interim_transcript);\r\n"],[0,"    if (fina"]],"start1":5865,"start2":5865,"length1":24,"length2":59}]],"length":8355,"saved":false}
{"ts":1366832801019,"patch":[[{"diffs":[[0,");\r\n  }\r"],[1,"\n  \r\n  var showFinalWord = function(text){\r\n    controller.createFinal(text);\r\n  }\r"],[0,"\n\r\n  rec"]],"start1":4953,"start2":4953,"length1":16,"length2":99},{"diffs":[[0,"        "],[1,"showFinalWord(final_transcript);"],[0,"\r\n      "]],"start1":5507,"start2":5507,"length1":16,"length2":48}]],"length":8470,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366914256787,"patch":[[{"diffs":[[0,"nalWord("],[-1,"final_"],[1,"event.results[i][0]."],[0,"transcri"]],"start1":5521,"start2":5521,"length1":22,"length2":36}]],"length":8484,"saved":false}
{"ts":1366916698115,"patch":[[{"diffs":[[0,");\r\n  }\r"],[1,"\n  \r\n  var showGarbageTruck = function(){\r\n    controller.showGarbageTruck();\r\n  }\r"],[0,"\n\r\n  rec"]],"start1":5036,"start2":5036,"length1":16,"length2":99},{"diffs":[[0,"    "],[-1,"showF"],[1,"var f"],[0,"inal"],[-1,"Word("],[1,"_word = "],[0,"even"]],"start1":5594,"start2":5594,"length1":22,"length2":25},{"diffs":[[0,"i][0].transcript"],[-1,")"],[0,";"],[1,"\r\n        showFinalWord(final_word);\r\n        if(final_word.toLower() === \"garbage truck\"){\r\n          showGarbageTruck();\r\n        }"],[0,"\r\n      } else {"]],"start1":5629,"start2":5629,"length1":34,"length2":166}]],"length":8702,"saved":false}
{"ts":1366917380748,"patch":[[{"diffs":[[0,".toLower"],[1,"Case"],[0,"() === \""]],"start1":5705,"start2":5705,"length1":16,"length2":20}]],"length":8706,"saved":false}
{"ts":1366917498371,"patch":[[{"diffs":[[0,"ord."],[-1,"toLowerCase() === "],[1,"indexOf("],[0,"\"gar"]],"start1":5702,"start2":5702,"length1":26,"length2":16},{"diffs":[[0," truck\")"],[1," > 0 )"],[0,"{\r\n     "]],"start1":5722,"start2":5722,"length1":16,"length2":22}]],"length":8702,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366919158623,"patch":[[{"diffs":[[0,"ord."],[-1,"indexOf(\""],[1,"trim() === '"],[0,"garb"]],"start1":5702,"start2":5702,"length1":17,"length2":20},{"diffs":[[0,"ruck"],[-1,"\") > 0"],[1,"'"],[0," ){\r"]],"start1":5727,"start2":5727,"length1":14,"length2":9}]],"length":8700,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366999789223,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"  copy_button.style.display = style;\r\n"],[0,"  em"]],"start1":8543,"start2":8543,"length1":46,"length2":8}]],"length":8662,"saved":false}
{"ts":1366999802040,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"  email_button.style.display = style;\r\n"],[0,"  co"]],"start1":8543,"start2":8543,"length1":47,"length2":8}]],"length":8623,"saved":false}
{"ts":1366999809926,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"  copy_info.style.display = 'none';\r\n  email_info.style.display = 'none';\r\n"],[0,"}"]],"start1":8543,"start2":8543,"length1":80,"length2":5}]],"length":8548,"saved":false}
{"ts":1367001634626,"patch":[[{"diffs":[[0,"== '"],[-1,"garbage truck"],[1,"cat"],[0,"' ){"]],"start1":5714,"start2":5714,"length1":21,"length2":11}]],"length":8538,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367287238647,"patch":[[{"diffs":[[0,"unction(text){\r\n"],[1,"    if(text.toLowerCase() === 'stop'){\r\n      controller.stopAnimation();\r\n    }\r\n"],[0,"    controller.c"]],"start1":4989,"start2":4989,"length1":32,"length2":114}]],"length":8620,"saved":false}
